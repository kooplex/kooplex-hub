{% extends 'project_layout.html' %}

{% load extras %}

{% block bodycontent %}
<div class="container" style="overflow-x:hidden;">
  <form id="project_new" class="form-horizontal was-validated" action="{% url 'project:new' %}" method="post">
    {% csrf_token %}
  <div class="card bg-light border-secondary shadow p-3">
    {% title "Describe your new project" %}
    <div class="container-fluid d-flex flex-column flex-md-row">
      <div class="d-flex w-100 w-md-75">
        <table>
          {{ form.as_table }}
        </table>
      </div>
      <div class="d-flex ms-3 w-100 w-md-50">
        <div data-toggle="tooltip" title="Please select an option from the image dropdown to check its description." class="d-flex bg-warning rounded p-2 w-100 mt-2 mt-md-0">
          <p class="fw-bolder">Image description:&nbsp;</p>
	  <p id="imageDescription"></p>
	</div>
      </div>
      {{ form.descriptions }}
    </div>
    {% apply_cancel hide_cancel=True label_apply='Create' icon_apply='bi bi-person-workspace' %}
  </div>
  </form>
</div>
{% endblock %}

{% block scripts %}
<script>
function unselect_envs() {
  console.log('unselect envs');
  $( "#id_environments option" ).each(function() {
    $(this).prop('selected', false);
  });
}
$("select[name='image'").change(function() {
    $( "#id_image option:selected" ).each(function() {
        var id = $(this).attr("value");
        console.log( $( this ).text() + " -> " + id);
	if (id === "") {
	    $("#imageDescription").text("");
	} else {
	    var description = $("#image-description-" + id).attr("value");
	    $("#imageDescription").text(description);
            unselect_envs();
	}
    });
}).change();
$( document ).ready(function() {
  unselect_envs();
});
</script>
{% endblock %}
